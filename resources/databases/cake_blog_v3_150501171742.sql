-- MySQL Script generated by MySQL Workbench
-- Mon 27 Apr 2015 12:04:11 PM ICT
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema cake_blog
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `cake_blog` ;

-- -----------------------------------------------------
-- Schema cake_blog
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `cake_blog` DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ;
USE `cake_blog` ;

-- -----------------------------------------------------
-- Table `cake_blog`.`categories`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `cake_blog`.`categories` ;

CREATE TABLE IF NOT EXISTS `cake_blog`.`categories` (
  `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NULL DEFAULT NULL,
  `slug` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NULL DEFAULT NULL,
  `parent_id` INT(10) NOT NULL DEFAULT '1',
  `path` VARCHAR(100) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NOT NULL DEFAULT '1',
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
AUTO_INCREMENT = 3
DEFAULT CHARACTER SET = utf8;

CREATE UNIQUE INDEX `slug_UNIQUE` ON `cake_blog`.`categories` (`slug` ASC);


-- -----------------------------------------------------
-- Table `cake_blog`.`roles`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `cake_blog`.`roles` ;

CREATE TABLE IF NOT EXISTS `cake_blog`.`roles` (
  `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(50) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NOT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
AUTO_INCREMENT = 4
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_unicode_ci;


-- -----------------------------------------------------
-- Table `cake_blog`.`users`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `cake_blog`.`users` ;

CREATE TABLE IF NOT EXISTS `cake_blog`.`users` (
  `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  `username` VARCHAR(100) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NOT NULL,
  `email` VARCHAR(100) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NOT NULL,
  `full_name` VARCHAR(100) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NULL DEFAULT NULL,
  `password` VARCHAR(72) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NOT NULL,
  `role_id` INT(10) UNSIGNED NOT NULL DEFAULT '3',
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  CONSTRAINT `us_role_key`
    FOREIGN KEY (`role_id`)
    REFERENCES `cake_blog`.`roles` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
AUTO_INCREMENT = 3
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_unicode_ci;

CREATE UNIQUE INDEX `username` ON `cake_blog`.`users` (`username` ASC, `email` ASC);

CREATE INDEX `us_role_key_idx` ON `cake_blog`.`users` (`role_id` ASC);


-- -----------------------------------------------------
-- Table `cake_blog`.`posts`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `cake_blog`.`posts` ;

CREATE TABLE IF NOT EXISTS `cake_blog`.`posts` (
  `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  `parent_id` INT(10) UNSIGNED NOT NULL DEFAULT '0',
  `user_id` INT(10) UNSIGNED NOT NULL,
  `title` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NULL DEFAULT NULL,
  `slug` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NULL DEFAULT NULL,
  `body` TEXT CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NULL DEFAULT NULL,
  `status` INT(10) NOT NULL DEFAULT '0',
  `created_at` DATETIME NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  CONSTRAINT `ps_user_key`
    FOREIGN KEY (`user_id`)
    REFERENCES `cake_blog`.`users` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
AUTO_INCREMENT = 8
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_unicode_ci;

CREATE UNIQUE INDEX `slug` ON `cake_blog`.`posts` (`slug` ASC);

CREATE INDEX `ps_user_key_idx` ON `cake_blog`.`posts` (`user_id` ASC);


-- -----------------------------------------------------
-- Table `cake_blog`.`comments`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `cake_blog`.`comments` ;

CREATE TABLE IF NOT EXISTS `cake_blog`.`comments` (
  `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  `body` VARCHAR(100) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NOT NULL,
  `user_id` INT(10) UNSIGNED NOT NULL,
  `post_id` INT(10) UNSIGNED NOT NULL,
  `parent_id` INT(10) NOT NULL DEFAULT '0',
  `path` VARCHAR(100) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NOT NULL DEFAULT '1',
  `status` INT(10) NOT NULL DEFAULT '1',
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  CONSTRAINT `cm_post_key`
    FOREIGN KEY (`post_id`)
    REFERENCES `cake_blog`.`posts` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `cm_user_key`
    FOREIGN KEY (`user_id`)
    REFERENCES `cake_blog`.`users` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

CREATE INDEX `user_key_idx` ON `cake_blog`.`comments` (`user_id` ASC);

CREATE INDEX `post_key_idx` ON `cake_blog`.`comments` (`post_id` ASC);


-- -----------------------------------------------------
-- Table `cake_blog`.`permissions`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `cake_blog`.`permissions` ;

CREATE TABLE IF NOT EXISTS `cake_blog`.`permissions` (
  `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  `controller` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NOT NULL,
  `action` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NULL DEFAULT NULL,
  `type` ENUM('0','1') CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NOT NULL DEFAULT '1',
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
AUTO_INCREMENT = 3
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_unicode_ci;


-- -----------------------------------------------------
-- Table `cake_blog`.`posts_categories`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `cake_blog`.`posts_categories` ;

CREATE TABLE IF NOT EXISTS `cake_blog`.`posts_categories` (
  `post_id` INT(10) UNSIGNED NOT NULL,
  `category_id` INT(10) UNSIGNED NOT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`post_id`, `category_id`),
  CONSTRAINT `pc_category_key`
    FOREIGN KEY (`category_id`)
    REFERENCES `cake_blog`.`categories` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `pc_post_key`
    FOREIGN KEY (`post_id`)
    REFERENCES `cake_blog`.`posts` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_unicode_ci;

CREATE INDEX `category_idx` ON `cake_blog`.`posts_categories` (`category_id` ASC, `post_id` ASC);


-- -----------------------------------------------------
-- Table `cake_blog`.`tags`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `cake_blog`.`tags` ;

CREATE TABLE IF NOT EXISTS `cake_blog`.`tags` (
  `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NULL DEFAULT NULL,
  `slug` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_unicode_ci' NULL DEFAULT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
AUTO_INCREMENT = 3
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_unicode_ci;

CREATE UNIQUE INDEX `slug_UNIQUE` ON `cake_blog`.`tags` (`slug` ASC);


-- -----------------------------------------------------
-- Table `cake_blog`.`posts_tags`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `cake_blog`.`posts_tags` ;

CREATE TABLE IF NOT EXISTS `cake_blog`.`posts_tags` (
  `post_id` INT(10) UNSIGNED NOT NULL,
  `tag_id` INT(10) UNSIGNED NOT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`tag_id`, `post_id`),
  CONSTRAINT `pt_post_key`
    FOREIGN KEY (`post_id`)
    REFERENCES `cake_blog`.`posts` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `pt_tag_key`
    FOREIGN KEY (`tag_id`)
    REFERENCES `cake_blog`.`tags` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_unicode_ci;

CREATE INDEX `pt_post_key` ON `cake_blog`.`posts_tags` (`post_id` ASC);

CREATE INDEX `tag_idx` ON `cake_blog`.`posts_tags` (`tag_id` ASC, `post_id` ASC);


-- -----------------------------------------------------
-- Table `cake_blog`.`roles_permissions`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `cake_blog`.`roles_permissions` ;

CREATE TABLE IF NOT EXISTS `cake_blog`.`roles_permissions` (
  `role_id` INT(10) UNSIGNED NOT NULL,
  `permission_id` INT(10) UNSIGNED NOT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`role_id`, `permission_id`),
  CONSTRAINT `rp_permission_key`
    FOREIGN KEY (`permission_id`)
    REFERENCES `cake_blog`.`permissions` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `rp_role_key`
    FOREIGN KEY (`role_id`)
    REFERENCES `cake_blog`.`roles` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_unicode_ci;

CREATE INDEX `rp_permission_key_idx` ON `cake_blog`.`roles_permissions` (`permission_id` ASC);


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `cake_blog`.`categories`
-- -----------------------------------------------------
START TRANSACTION;
USE `cake_blog`;
INSERT INTO `cake_blog`.`categories` (`id`, `name`, `slug`, `parent_id`, `path`, `created_at`, `updated_at`) VALUES (1, 'Uncategorized', 'uncategorized', 0, '1', '2015-04-18 09:18:00', '2015-04-18 09:18:00');

COMMIT;


-- -----------------------------------------------------
-- Data for table `cake_blog`.`roles`
-- -----------------------------------------------------
START TRANSACTION;
USE `cake_blog`;
INSERT INTO `cake_blog`.`roles` (`id`, `name`, `created_at`, `updated_at`) VALUES (1, 'Administrator', '2015-04-18 09:18:00', '2015-04-18 09:18:00');
INSERT INTO `cake_blog`.`roles` (`id`, `name`, `created_at`, `updated_at`) VALUES (2, 'Moderator', '2015-04-18 09:18:00', '2015-04-18 09:18:00');
INSERT INTO `cake_blog`.`roles` (`id`, `name`, `created_at`, `updated_at`) VALUES (3, 'User', '2015-04-18 09:18:00', '2015-04-18 09:18:00');

COMMIT;


-- -----------------------------------------------------
-- Data for table `cake_blog`.`users`
-- -----------------------------------------------------
START TRANSACTION;
USE `cake_blog`;
INSERT INTO `cake_blog`.`users` (`id`, `username`, `email`, `full_name`, `password`, `role_id`, `created_at`, `updated_at`) VALUES (1, 'admin', 'admin@localhost', 'Administrator', '$2y$10$mAm8wAkoZvThj13ODxSlCuDtjgk9FEoUHjvRQG8jPipPLROgg2kd2', 1, '2015-04-18 09:18:00', '2015-04-18 09:18:00');
INSERT INTO `cake_blog`.`users` (`id`, `username`, `email`, `full_name`, `password`, `role_id`, `created_at`, `updated_at`) VALUES (2, 'user', 'user@localhost', 'User', '$2y$10$FU/ZtI89O4YY9dkocNeomuLa6i8vXdJvMo6POyfgLP2lHfDrHWL3K', 3, '2015-04-18 09:18:00', '2015-04-18 09:18:00');

COMMIT;


-- -----------------------------------------------------
-- Data for table `cake_blog`.`posts`
-- -----------------------------------------------------
START TRANSACTION;
USE `cake_blog`;
INSERT INTO `cake_blog`.`posts` (`id`, `parent_id`, `user_id`, `title`, `slug`, `body`, `status`, `created_at`, `updated_at`) VALUES (1, 0, 1, 'Hello, world!', 'hello-world', 'This is the first post!', 3, '2015-04-18 09:18:00', '2015-04-18 09:18:00');

COMMIT;


-- -----------------------------------------------------
-- Data for table `cake_blog`.`comments`
-- -----------------------------------------------------
START TRANSACTION;
USE `cake_blog`;
INSERT INTO `cake_blog`.`comments` (`id`, `body`, `user_id`, `post_id`, `parent_id`, `path`, `status`, `created_at`, `updated_at`) VALUES (1, 'This is the first comment!', 1, 1, 0, '1', 3, '2015-04-18 09:18:00', '2015-04-18 09:18:00');

COMMIT;


-- -----------------------------------------------------
-- Data for table `cake_blog`.`permissions`
-- -----------------------------------------------------
START TRANSACTION;
USE `cake_blog`;
INSERT INTO `cake_blog`.`permissions` (`id`, `controller`, `action`, `type`, `created_at`, `updated_at`) VALUES (1, '*', '*', '1', '2015-04-18 09:18:00', '2015-04-18 09:18:00');
INSERT INTO `cake_blog`.`permissions` (`id`, `controller`, `action`, `type`, `created_at`, `updated_at`) VALUES (2, 'users', '*', '1', '2015-04-18 09:18:00', '2015-04-18 09:18:00');
INSERT INTO `cake_blog`.`permissions` (`id`, `controller`, `action`, `type`, `created_at`, `updated_at`) VALUES (3, 'users', 'add', '0', '2015-04-18 09:18:00', '2015-04-18 09:18:00');
INSERT INTO `cake_blog`.`permissions` (`id`, `controller`, `action`, `type`, `created_at`, `updated_at`) VALUES (4, 'roles', '*', '0', '2015-04-18 09:18:00', '2015-04-18 09:18:00');
INSERT INTO `cake_blog`.`permissions` (`id`, `controller`, `action`, `type`, `created_at`, `updated_at`) VALUES (5, 'permissions', '*', '0', '2015-04-18 09:18:00', '2015-04-18 09:18:00');

COMMIT;


-- -----------------------------------------------------
-- Data for table `cake_blog`.`posts_categories`
-- -----------------------------------------------------
START TRANSACTION;
USE `cake_blog`;
INSERT INTO `cake_blog`.`posts_categories` (`post_id`, `category_id`, `created_at`, `updated_at`) VALUES (1, 1, '2015-04-18 09:18:00', '2015-04-18 09:18:00');

COMMIT;


-- -----------------------------------------------------
-- Data for table `cake_blog`.`tags`
-- -----------------------------------------------------
START TRANSACTION;
USE `cake_blog`;
INSERT INTO `cake_blog`.`tags` (`id`, `name`, `slug`, `created_at`, `updated_at`) VALUES (1, 'uncategorized', 'uncategorized', '2015-04-18 09:18:00', '2015-04-18 09:18:00');
INSERT INTO `cake_blog`.`tags` (`id`, `name`, `slug`, `created_at`, `updated_at`) VALUES (2, 'blog', 'blog', '2015-04-18 09:18:00', '2015-04-18 09:18:00');

COMMIT;


-- -----------------------------------------------------
-- Data for table `cake_blog`.`posts_tags`
-- -----------------------------------------------------
START TRANSACTION;
USE `cake_blog`;
INSERT INTO `cake_blog`.`posts_tags` (`post_id`, `tag_id`, `created_at`, `updated_at`) VALUES (1, 1, '2015-04-18 09:18:00', '2015-04-18 09:18:00');
INSERT INTO `cake_blog`.`posts_tags` (`post_id`, `tag_id`, `created_at`, `updated_at`) VALUES (1, 2, '2015-04-18 09:18:00', '2015-04-18 09:18:00');

COMMIT;


-- -----------------------------------------------------
-- Data for table `cake_blog`.`roles_permissions`
-- -----------------------------------------------------
START TRANSACTION;
USE `cake_blog`;
INSERT INTO `cake_blog`.`roles_permissions` (`role_id`, `permission_id`, `created_at`, `updated_at`) VALUES (1, 1, '2015-04-18 09:18:00', '2015-04-18 09:18:00');
INSERT INTO `cake_blog`.`roles_permissions` (`role_id`, `permission_id`, `created_at`, `updated_at`) VALUES (3, 2, '2015-04-18 09:18:00', '2015-04-18 09:18:00');
INSERT INTO `cake_blog`.`roles_permissions` (`role_id`, `permission_id`, `created_at`, `updated_at`) VALUES (3, 3, '2015-04-18 09:18:00', '2015-04-18 09:18:00');
INSERT INTO `cake_blog`.`roles_permissions` (`role_id`, `permission_id`, `created_at`, `updated_at`) VALUES (3, 4, '2015-04-18 09:18:00', '2015-04-18 09:18:00');
INSERT INTO `cake_blog`.`roles_permissions` (`role_id`, `permission_id`, `created_at`, `updated_at`) VALUES (3, 5, '2015-04-18 09:18:00', '2015-04-18 09:18:00');

COMMIT;

